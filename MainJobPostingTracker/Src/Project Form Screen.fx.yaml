"'Project Form Screen' As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    Fill: =RGBA(241, 244, 249, 1)
    OnVisible: |-
        =If(
            varFormmode = FormMode.New,
            ClearCollect(
                colRequiredTeam,
                {
                    Vacancies: "",
                    Role: First(Choices('Required Team List'.Role)),
                    RowNumber: 1
                }
            ),
            ClearCollect(
                colRequiredTeam,
                Filter(
                    'Required Team List',
                    Text(varProjectID) = Title
                )
            )
        )

    Canvas1 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =688
        Width: =Parent.Width
        Y: =Header_3.Y+Header_3.Height
        ZIndex: =3

        DataCard3 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =585
            Width: =Parent.Width
            WidthFit: =false
            X: =0
            Y: =0
            ZIndex: =1

            TextInput4 As text:
                Default: =""
                DisabledFill: =RGBA(255, 255, 255, 1)
                DisplayMode: =Disabled
                Fill: =RGBA(251, 188, 159, 1)
                Height: =txtDescrition_1.Y+txtDescrition_1.Height-30
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =1235
                X: =55
                Y: =90
                ZIndex: =1

            Label5_4 As label:
                Height: =30
                Text: ="Project Name"
                X: =70
                Y: =TextInput4.Y+30
                ZIndex: =2

            projectname_1 As text:
                Default: =If(varFormmode=FormMode.New,"",varItem.Title)
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                FocusedBorderThickness: |
                    =2
                Height: =30
                HintText: ="Add a short clear name"
                PaddingBottom: =7
                Width: =400
                X: =Label5_4.X+Label5_4.Width
                Y: =Label5_4.Y
                ZIndex: =3

            Label5_6 As label:
                Height: =30
                Text: ="Required Team"
                X: =Label5_5.X
                Y: |
                    =Label5_5.Y+Label5_5.Height+30
                ZIndex: =4

            Gallery4_1 As gallery.galleryVertical:
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                Height: =CountRows(Self.AllItems)*(Self.TemplateHeight+10)
                Items: =colRequiredTeam
                Layout: =Layout.Vertical
                TemplateSize: =45
                Width: =400
                X: =Label5_6.X+Label5_6.Width
                Y: =Label5_6.Y
                ZIndex: =5

                TextInput6_1 As text:
                    Default: =ThisItem.Vacancies
                    DisabledColor: =RGBA(116, 116, 116, 1)
                    Height: =30
                    HintText: ="0"
                    OnChange: |-
                        =Patch(colRequiredTeam,ThisItem,{Vacancies:Self.Text})
                    OnSelect: =Select(Parent)
                    Width: =100
                    ZIndex: =1

                Dropdown1_1 As dropdown:
                    BorderThickness: =1
                    ChevronBackground: =RGBA(0, 0, 0, 0)
                    ChevronFill: =RGBA(9, 33, 98, 1)
                    Default: =If(IsBlank(ThisItem.Role),"",ThisItem.Role.Value)
                    DisabledColor: =RGBA(116, 116, 116, 1)
                    Height: =30
                    Items: =Choices('Required Team List'.Role)
                    OnChange: |-
                        =Patch(colRequiredTeam,ThisItem,{Role:Self.Selected})
                    OnSelect: =Select(Parent)
                    Width: =200
                    X: =120
                    ZIndex: =2

                Icon2_1 As icon.Trash:
                    Height: =30
                    Icon: =Icon.Trash
                    OnSelect: =Remove(colRequiredTeam,ThisItem)
                    Width: =40
                    X: =340
                    ZIndex: =3

            Label5_7 As label:
                Height: =67
                Text: ="Project Decription"
                X: =Label5_6.X
                Y: |
                    =txtDescrition_1.Y+50
                ZIndex: =6

            txtDescrition_1 As text:
                Default: =If(varFormmode=FormMode.New,"",varItem.'Description ')
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                Height: =177
                Mode: =TextMode.MultiLine
                Width: =400
                X: =Label5_7.X+Label5_7.Width
                Y: =Button4_1.Y+Button4_1.Height+20
                ZIndex: =7

            Label5_5 As label:
                Height: =30
                Text: ="Project Type"
                X: =Label5_4.X
                Y: =Label5_4.Y+Label5_4.Height+30
                ZIndex: =8

            DrpProjecttyped_1 As dropdown:
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(0, 18, 107, 1)
                Default: =If(varFormmode=FormMode.New,"",varItem.'Project Type'.Value)
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                FocusedBorderThickness: |
                    =2
                Height: =30
                Items: |-
                    =Ungroup(
                        Table(
                            {DropdownOptions: ["Select Project Type"]},
                            {DropdownOptions:Choices('Project Detail List'.'Project Type')}
                        ),
                        "DropdownOptions"
                    )
                SelectionColor: =RGBA(0, 0, 0, 1)
                SelectionFill: =RGBA(0, 0, 0, 0)
                Width: =400
                X: =Label5_5.X+Label5_5.Width
                Y: =Label5_5.Y
                ZIndex: =9

            Label5_8 As label:
                Height: =30
                Text: ="Project Start Date (if you are not sure,provide tentative date)"
                Width: =510
                X: =700
                Y: =Label5_4.Y
                ZIndex: =12

            Group3_1 As group:
                Height: =5
                Width: =5
                X: =-110
                Y: =-632
                ZIndex: =12

                Button4_1 As button:
                    BorderColor: =RGBA(166, 166, 166, 1)
                    BorderThickness: =1
                    Color: =RGBA(56, 96, 178, 1)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderThickness: =1
                    Height: =35
                    HoverBorderColor: =Self.BorderColor
                    HoverColor: =Self.Color
                    HoverFill: =Self.Fill
                    OnSelect: |
                        =Collect(
                            colRequiredTeam,
                            {
                                Vacancies: "",
                                Role: First(Choices('Required Team List'.Role)),
                                RowNumber:CountRows(Gallery4_1.AllItems)+1
                            }
                        );
                    PaddingBottom: =7
                    PaddingLeft: =30
                    PressedBorderColor: =Self.BorderColor
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Add Role"
                    Visible: =varFormmode<>FormMode.View
                    Width: =130
                    X: =Label5_6.X+Label5_6.Width
                    Y: =Gallery4_1.Y+Gallery4_1.Height+10
                    ZIndex: =10

                Icon6_1 As icon.Add:
                    Color: =If(Button4_1.Pressed,White,RGBA(56, 96, 178, 1))
                    Height: =25
                    Icon: =Icon.Add
                    OnSelect: |
                        =Collect(
                            colRequiredTeam,
                            {
                                Vacancies: "",
                                Role: First(Choices('Required Team List'.Role)),
                                RowNumber:CountRows(Gallery4_1.AllItems)+1
                            }
                        );
                    PressedColor: =Self.Color
                    Visible: =varFormmode<>FormMode.View
                    Width: =25
                    X: =Label5_6.X+Label5_6.Width
                    Y: |
                        =Gallery4_1.Y+Gallery4_1.Height+15
                    ZIndex: =11

            Radio1 As radio:
                Default: =If(varFormmode=FormMode.New,"",If(varItem.'Start Date'="Immediate","Immediate","Pick a date"))
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                FocusedBorderThickness: |
                    =0
                Height: =40
                Items: |-
                    =Table({Value:"Immediate"},{Value:"Pick a date"})
                Layout: =Layout.Horizontal
                PaddingBottom: =0
                PaddingTop: =0
                Size: =15
                Width: =373
                X: =Label5_8.X
                Y: =Label5_8.Y+Label5_8.Height+10
                ZIndex: =13

            DatePicker1 As datepicker:
                DefaultDate: =Text(If(varFormmode=FormMode.New,Today(),If(varItem.'Start Date'="Immediate",Today(),DateValue(varItem.'Start Date'))),"d-mmm-yyyy")
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                Height: =30
                Visible: =If(Radio1.Selected.Value="Pick a date",true,false)
                Width: =200
                X: =1050
                Y: =Radio1.Y
                ZIndex: =14

            Label5_9 As label:
                Height: =30
                Text: ="Duration"
                X: =Label5_8.X
                Y: =Radio1.Y+Radio1.Height+30
                ZIndex: =15

            projectname_2 As text:
                Default: =If(varFormmode=FormMode.New,"",varItem.'Duration Number')
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                FocusedBorderThickness: |
                    =2
                Height: =30
                HintText: ="0"
                PaddingBottom: =7
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =100
                X: =Label5_9.X+Label5_9.Width
                Y: =Label5_9.Y
                ZIndex: =16

            DrpProjecttyped_2 As dropdown:
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(0, 18, 107, 1)
                Default: =If(varFormmode=FormMode.New,"",varItem.'Project Type'.Value)
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                FocusedBorderThickness: |
                    =2
                Height: =30
                Items: |-
                    =//Ungroup(Table({DropdownOptions:["Select Project Type"]},{DropdownOptions:Choices('Project Detail List'.'Project Type')}),"DropdownOptions")
                    Choices('Project Detail List'.'Duration Type')
                SelectionColor: =RGBA(0, 0, 0, 1)
                SelectionFill: =RGBA(0, 0, 0, 0)
                Width: =280
                X: =projectname_2.X+projectname_2.Width+20
                Y: =Label5_9.Y
                ZIndex: =17

            Label5_10 As label:
                Height: =30
                Text: ="Category"
                X: =Label5_9.X
                Y: =Label5_9.Y+Label5_9.Height+30
                ZIndex: =18

            DrpProjecttyped_3 As dropdown:
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(0, 18, 107, 1)
                Default: =If(varFormmode=FormMode.New,"",varItem.Category.Value)
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                FocusedBorderThickness: |
                    =2
                Height: =30
                Items: |-
                    =
                    
                    Ungroup(
                        Table(
                            {DropdownOptions: ["Select Project Category"]},
                            {DropdownOptions:Choices('Project Detail List'.Category)}
                        ),
                        "DropdownOptions"
                    )
                SelectionColor: =RGBA(0, 0, 0, 1)
                SelectionFill: =RGBA(0, 0, 0, 0)
                Width: =400
                X: =Label5_10.X+Label5_10.Width
                Y: =Label5_10.Y
                ZIndex: =19

            Label5_11 As label:
                Height: =30
                Text: ="Required Skill"
                X: =Label5_10.X
                Y: |
                    =Label5_10.Y+Label5_10.Height+30
                ZIndex: =20

            ComboBox1 As combobox:
                ChevronBackground: =RGBA(255, 255, 255, 1)
                ChevronDisabledFill: =RGBA(230, 230, 230, 1)
                ChevronFill: =RGBA(39, 113, 194, 1)
                ChevronHoverFill: =RGBA(214, 223, 238, 1)
                Default: |-
                    =If(
                     varFormmode=FormMode.New,{},
                     {Value:varItem.Skills.Value}
                    )
                DefaultSelectedItems: =If(varFormmode=FormMode.New,Table({}),varItem.Skills.Value)
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayFields: =["Value"]
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                Height: =30
                HoverFill: =RGBA(214, 223, 238, 1)
                InputTextPlaceholder: ="Add skills here"
                IsSearchable: =false
                Items: =Choices('Project Detail List'.Skills).Value
                PressedColor: =RGBA(0, 0, 0, 1)
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectionColor: =RGBA(0, 18, 107, 1)
                SelectionFill: =RGBA(215, 223, 240, 1)
                Width: =400
                X: =Label5_11.X+Label5_11.Width
                Y: =Label5_11.Y
                ZIndex: =21

            Label5_12 As label:
                Height: =30
                Text: ="Project Status"
                X: =Label5_11.X
                Y: =Label5_11.Y+Label5_11.Height+30
                ZIndex: =22

            DrpProjecttyped_4 As dropdown:
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(0, 18, 107, 1)
                Default: =If(varFormmode=FormMode.New,"",varItem.Status.Value)
                DisabledColor: =RGBA(116, 116, 116, 1)
                DisplayMode: =If(varFormmode=FormMode.View,Disabled,Edit)
                FocusedBorderThickness: |
                    =2
                Height: =30
                Items: |-
                    =
                    
                    Ungroup(
                        Table(
                            {DropdownOptions: ["Select Project Status"]},
                            {DropdownOptions:Choices('Project Detail List'.Status)}
                        ),
                        "DropdownOptions"
                    )
                SelectionColor: =RGBA(0, 0, 0, 1)
                SelectionFill: =RGBA(0, 0, 0, 0)
                Width: =400
                X: =Label5_10.X+Label5_10.Width
                Y: =Label5_12.Y
                ZIndex: =23

            Label23_3 As label:
                Align: =Align.Center
                BorderColor: =RGBA(255, 191, 0, 1)
                BorderThickness: =2
                Color: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(255, 191, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =50
                Size: =25
                Text: =Switch(varFormmode,FormMode.New,"Add New Project",FormMode.Edit,"Edit Project",FormMode.View,"View Project")
                Width: =TextInput4.Width
                X: =TextInput4.X
                Y: =TextInput4.Y-Self.Height
                ZIndex: =24

            Icon3 As icon.ArrowLeft:
                Color: =RGBA(255, 255, 255, 1)
                Height: =50
                Icon: =Icon.ArrowLeft
                OnSelect: =If(vartabselected=4,Navigate('Manage Project Screen'),Navigate('Archived Project Screen'))
                X: =Label23_3.X+5
                Y: |
                    =Label23_3.Y
                ZIndex: =25

            Button5_2 As button:
                BorderColor: =RGBA(9, 33, 98, 1)
                Color: =RGBA(9, 33, 98, 1)
                Fill: =RGBA(255, 255, 255, 1)
                OnSelect: |-
                    =If(
                        varFormmode=FormMode.New,
                        Set(
                            varProjectID,
                            Patch(
                                'Project Detail List',
                                Defaults('Project Detail List'),
                                {
                                  Title:projectname_1.Text,
                                  'Project Type':{
                                        Value:  DrpProjecttyped_1.Selected.Value,
                                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                                  'Description ':txtDescrition_1.Text,
                                  'Start Date': If(Radio1.Selected.Value="Immediate","Immediate",Text(DatePicker1.SelectedDate,"dd-mmm-yyyy")),
                                   'Duration Number':projectname_2.Text,
                                   'Duration Type':{
                                        Value:  DrpProjecttyped_2.Selected.Value,
                                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                                       Skills:ComboBox1.SelectedItems.Value,
                                       Category: { 
                                           Value:DrpProjecttyped_3.Selected.Value,
                                           '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                                       Status:{ 
                                           Value:DrpProjecttyped_4.Selected.Value,
                                           '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                                       Role:Concat(colRequiredTeam, Role.Value, ", ")
                    
                                       }
                    
                            ).ID
                    );
                    Set(varItem,LookUp('Project Detail List',ID=varProjectID));
                    Set(varFormmode,FormMode.Edit);
                    ,
                    Patch('Project Detail List',
                        LookUp('Project Detail List',ID=varProjectID),
                        {
                                  Title:projectname_1.Text,
                                  'Project Type':{
                                        Value:  DrpProjecttyped_1.Selected.Value,
                                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                                       'Description ':txtDescrition_1.Text,
                                       'Start Date': If(Radio1.Selected.Value="Immediate","Immediate",Text(DatePicker1.SelectedDate,"dd-mmm-yyyy")),
                                       'Duration Number':projectname_2.Text,
                                       'Duration Type':{
                                        Value:  DrpProjecttyped_2.Selected.Value,
                                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                                       Skills:ComboBox1.SelectedItems.Value,
                                       Category: { 
                                           Value:DrpProjecttyped_3.Selected.Value,
                                           '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                                       Status:{ 
                                           Value:DrpProjecttyped_4.Selected.Value,
                                           '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                                       Role:Concat(colRequiredTeam, Role.Value, ", ")
                        }
                    )
                    );
                    RemoveIf('Required Team List', Text(varProjectID) in Title);
                    ForAll(Gallery4_1.AllItems,
                    Patch('Required Team List',
                    Defaults('Required Team List'),
                    { 
                        Title:varProjectID,
                        Role:{
                                        Value:  Dropdown1_1.Selected.Value,
                                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"
                                       },
                        Vacancies:TextInput6_1.Text               
                    
                    }
                    )
                    );
                    Notify("Your has been successfully submitted",2000);
                    If(DrpProjecttyped_4.Selected.Value<>"Archived",Navigate('Manage Project Screen'),Navigate('Archived Project Screen'));
                PaddingBottom: =7
                PressedBorderColor: =Self.Color
                Text: ="Submit"
                Visible: =varFormmode<>FormMode.View
                X: =1117
                Y: =TextInput4.Y+TextInput4.Height-Self.Height-20
                ZIndex: =26

    Header_3 As Header:
        LandingScreen: =
        ScreenTitle: ="Project Form"
        VisibleHome: =false
        ZIndex: =4

    imgCompanyLogo_5 As image:
        DisabledBorderColor: =RGBA(255, 255, 255, 1)
        DisabledFill: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.Disabled
        Fill: =RGBA(255, 255, 255, 1)
        Height: =Header_1.Height
        Image: ='binary_roots_logo-removebg-preview'
        Width: =200
        X: =Header_1.X
        Y: =Header_1.Y
        ZIndex: =5

